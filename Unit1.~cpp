//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit1.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;

int x = -6;
int y = -6;
int player1 = 0;
int player2 = 0;

//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
        : TForm(Owner)
{
}
//---------------------------------------------------------------------------

void __fastcall TForm1::up1Timer(TObject *Sender)
{
    if(p1->Top > 60 ) p1->Top -= 10;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::down1Timer(TObject *Sender)
{
    if(p1->Top + p1->Height < tlo->Height - 10 ) p1->Top += 10;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::up2Timer(TObject *Sender)
{
    if(p2->Top > 60 ) p2->Top -= 10;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::down2Timer(TObject *Sender)
{
   if(p2->Top + p2->Height < tlo->Height - 10 ) p2->Top += 10;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::FormKeyDown(TObject *Sender, WORD &Key,
      TShiftState Shift)
{
    if(Key == 'A') up1->Enabled = true;
    if(Key == 'Z') down1->Enabled = true;
    if(Key == VK_UP) up2->Enabled = true;
    if(Key == VK_DOWN) down2->Enabled = true;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::FormKeyUp(TObject *Sender, WORD &Key,
      TShiftState Shift)
{
    if(Key == 'A') up1->Enabled = false;
    if(Key == 'Z') down1->Enabled = false;
    if(Key == VK_UP) up2->Enabled = false;
    if(Key == VK_DOWN) down2->Enabled = false;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::ballTTimer(TObject *Sender)
{
      ball->Left += x;
      ball->Top += y;

      //odbij od gornej sciany
      if(ball->Top <= tlo->Top+41) y = -y;
      //odbij od dolnej sciany
      if(ball->Top + ball->Height >= tlo->Top+tlo->Height) y = -y;

      //rozgrywka
      if(ball->Left < tlo->Left){
          ballT->Enabled = false;
          ball->Visible = false;
          scoreInfo->Caption = "Punkt dla gracza 2 !";
          scoreInfo->Visible = true;
          //Sleep(2000);
          //scoreInfo->Visible = false;
          player2++;
      } else if (ball->Left+ball->Width > p2->Left+40) {
          ballT->Enabled = false;
          ball->Visible = false;
          scoreInfo->Caption = "Punkt dla gracza 1 !";
          scoreInfo->Visible = true;
          Sleep(2000);
          scoreInfo->Visible = false;
          player1++;
      } else if ((ball->Left <= p1->Left+p1->Width/2 && ball->Top+ball->Height >= p1->Top
               && ball->Top <= p1->Top + p1->Height)
      //|| ball->Left+ball->Width/2 >= p2->Left
      ){
          x = -x;
      }
}
//---------------------------------------------------------------------------


  /*
    //przegrana
    if(ball->Top >= paddle->Top + paddle->Height + 15){
        Timer_pilka->Enabled = false;
        ball->Visible = false;
        Button1->Caption = "Pora¿ka! Jeszcze raz?";
        Button1->Visible = true;
        //blokowanie ruchow paletki
        Form1->OnKeyDown = FormKeyUp;
    } else if (ball->Left > paddle->Left-ball->Width/2 && ball->Left < paddle->Left+paddle->Width &&
               ball->Top+ball->Height > paddle->Top){
               if ( y > 0 ) y = -y;
    }             */
